<article id="post-2274" class="post-2274 post type-post status-publish format-standard hentry category-design category-development category-publishing_platforms category-valiz tag-epub tag-epubster tag-medium clearfix" role="article" itemscope itemtype="http://schema.org/BlogPosting">
								<header class="article-header">
									<h1 class="entry-title single-title" itemprop="headline">Developing EPUBster</h1>
									<p class="byline vcard">By <span class="author"><a href="http://networkcultures.org/digitalpublishing/author/marcdebruijn/" title="Posts by Marc de Bruijn" rel="author">Marc de Bruijn</a></span>, <time class="updated" datetime="2014-11-19" pubdate>November 19, 2014 at 3:26 pm</time>.</p>
								</header>
								<section class="entry-content clearfix" itemprop="articleBody">
									<figure><img src="imgs/epubster-04.png"></figure><p>With <em>EPUBster</em> (for lack of a better name) we tried to develop a web application allowing publishers to edit and create EPUBs. We us the term ‘publisher’ very loosely in this instance, also referring to developers, designers or editors. <em>EPUBster</em> was partly developed for Amsterdam based publisher Valiz and designers Meeus Ontwerpt in order for them to create a series of books titled “Context Without Walls”. Their feedback at various points prompted some of the design and implementation decisions. As such the application is intended as a general purpose tool for generating EPUBs, but incorporating some very specific features, such as support for multiple indices.</p>
<p>The application can be broken down in a few components:</p>
<ul>
<li>A very simple metadata editor offering just the necessary fields as defined in the EPUB standard;</li>
<li>Section or chapter editor, used for rearranging and deleting chapters in an EPUB;</li>
<li>Content editor allowing the user to manipulate the text of a section/chapter;</li>
<li>Options to add a book cover and CSS styling.</li>
</ul>
<p>After creating an edition, filling in the required metadata and creating some chapters, the user is then able to generate or preview an EPUB based on the inputted data.</p>
<p>The same components used to build the application are represented in the user interface. The interface allows the publisher to author a publication step-by-step, from primary information and metadata input in the first tab of EPUBster to adding a cover as the last step of the process. To assist the user with the creation of a publication and provide a flexible workflow, one can switch between tabs and components of the application. This allows for a non-lineair workflow and the possibility of adding chapters to a publication or change the design by adding different CSS-files at a later stage.</p>
<h2>The Application</h2>
<p>At the time we decided to build the application using a PHP framework, <em>CakePHP</em>. Having developed multiple applications using the framework, <em>CakePHP</em> proved to be a familiar environment allowing us to rapidly prototype the features of the application. One of the downsides of CakePHP is the slowness of the framework compared to other offerings and the reliance on what’s often called “automagic” in Cake’s documentation. As our recent experiences with the <em>Laravel</em> framework, partly built on <em>Symfony</em>, have been very positive, the initial choice for <em>CakePHP</em> as a foundation doesn’t seem as straightforward at this point.</p>
<p>One of the restrictions that guided the development process was the requirement that the application should run on very common server hardware. As a lot of webhosting environments are of the “shared hosting” variety, making use of shell programs was out of the question. It would be relatively simple to build a web GUI on top of <em>calibre</em>’s command line interface or a document converter like <em>pandoc</em>. Instead we relied on PHP libraries for most of the generative features of the web application. Asbjorn Grandt’s <a href="https://github.com/Grandt/PHPePub" class="broken_link"><em>PHPePub</em></a> forms the core of the application and was packaged, with some modifications, as a Cake plugin in order to receive content from <em>EPUBster</em>’s MySQL database containing the publication data.</p>
<p>At first we focussed on processing Markdown formatted text as input for the various chapters/sections in a publication. After storing the Markdown text in a database this is then converted to HTML and subsequently processed by <em>PHPePub</em>. The conversion is done using the <a href="https://michelf.ca/projects/php-markdown/extra/" class="broken_link"><em>Markdown Extra</em></a> library packaged as Cake plugin <a href="https://github.com/maurymmarques/markdown-cakephp" class="broken_link">by Maury M. Marques</a>.<em>WYSIWYG</em> (What You See Is What You Get) orientated approach, while still supporting Markdown. The <em>WYSIWYG</em> editor is an extended version of Davi Ferreira’s <a href="https://github.com/daviferreira/medium-editor" class="broken_link"><em>Medium Editor</em></a>. As the editor manipulates HTML directly, no conversion is necessary prior to generating an EPUB. Due to the fact that the editor uses HTML5’s <em>contenteditable</em> behaviour there is support for parsing rich text pasted from text editors and word processors. Bolds, italics, colours, etc. will be pasted as HTML in a <em>contenteditable</em> element. This introduces several problems however, as some word processors (notably <em>Microsoft Word</em>) wrap formatted text in tags with a lot of style attributes, resulting in a lot of undesirable and superfluous markup when generating an EPUB. Stripping the unwanted markup (font-families, line-height, etc.), while leaving the desirable elements (bold, italic, etc.) in place took some modification of the <em>Medium Editor</em>’s codebase.</p>
<p>In earlier versions of the application it was only possible to preview a draft edition by generating an EPUB, downloading the file to the user’s harddrive and previewing said file in an ereader like <em>calibre</em> or <em>iBooks</em>. To provide a more immediate way to preview draft editions we decided to implement a JavaScript EPUB viewer. <em>ReadiumJS</em> seemed like a natural choice, as the project is backed by several large publishers and the <em>International Digital Publishing Forum</em>, the curators of the EPUB standard. However at the time of implementation, <em>ReadiumJS</em> – which is still in heavy development – proved to be too unstable for production use. Instead we opted for <a href="https://github.com/futurepress/epub.js/" class="broken_link"><em>epub.js</em></a> by Fred Chasen, an actively developed JavaScript library comparable to <em>ReadiumJS</em> which offers a more robust experience. When a user previews an edition in <em>EPUBster</em> an EPUB is generated on the fly and rendered in the browser using <em>epub.js</em>.</p>
<p>The current version of <em>EPUBster</em> <a href="https://github.com/DigitalPublishingToolkit/epubster" class="broken_link">is available on GitHub</a>. As it stands the application should be considered of alpha quality and could do with a lot more testing and polish. Testing of the EPUBs generated by the application on several ereading devices should be a priority, for example, should development on the application continue in some for or other. However, it should currently be possible to create a fully-fledged EPUB 3 without much trouble using the tools provided by <em>EPUBster</em>.</p>

		
		<div id="gallery-1" class="gallery galleryid-2274 gallery-columns-3 gallery-size-thumbnail">
<dl class="gallery-item">
			<dt class="gallery-icon landscape">
				<figure><img src="imgs/epubster-02.png"></figure>
</dt>
</dl>
<dl class="gallery-item">
			<dt class="gallery-icon landscape">
				<figure><img src="imgs/epubster-05.png"></figure>
</dt>
</dl>
<dl class="gallery-item">
			<dt class="gallery-icon landscape">
				<figure><img src="imgs/epubster-07.png"></figure>
</dt>
</dl>
<dl class="gallery-item">
			<dt class="gallery-icon landscape">
				<figure><img src="imgs/epubster-041.png"></figure>
</dt>
</dl>
<dl class="gallery-item">
			<dt class="gallery-icon landscape">
				<figure><img src="imgs/epubster-06.png"></figure>
</dt>
</dl>
<dl class="gallery-item">
			<dt class="gallery-icon landscape">
				<figure><img src="imgs/epubster-08.png"></figure>
</dt>
</dl>
<dl class="gallery-item">
			<dt class="gallery-icon landscape">
				<figure><img src="imgs/epubster-03.png"></figure>
</dt>
</dl>
			</div>

								</section>
								</article>
